import{g as p,h as u,i as d,s as c,t as w}from"../../chunk-MQYXRLYI.mjs";import{a as i}from"../../chunk-OYOJMOFP.mjs";var y=class h{constructor(e){this.options=e}static{i(this,"HuaweiApiGatewayAdapter")}getAdapterName(){return h.name}canHandle(e){let t=e;return!!(t&&t.httpMethod&&t.requestContext&&t.requestContext.apiId&&t.requestContext.stage&&t.requestContext.requestId&&!("multiValueQueryStringParameters"in t))}getRequest(e){let t=e.httpMethod,s=this.getPathFromEvent(e),a=u(e.headers,",",!0),r;if(e.body){let[o,g]=p(e.body,e.isBase64Encoded);r=o,a["content-length"]=String(g)}let n=a["x-real-ip"];return{method:t,headers:a,body:r,remoteAddress:n,path:s}}getResponse({headers:e,body:t,isBase64Encoded:s,statusCode:a}){let r=d(e);return{statusCode:a,body:t,headers:r,isBase64Encoded:s}}onErrorWhileForwarding({error:e,delegatedResolver:t,respondWithErrors:s,event:a,log:r}){let n=s?e.stack:"",o=this.getResponse({event:a,statusCode:500,body:n||"",headers:{},isBase64Encoded:!1,log:r});t.succeed(o)}getPathFromEvent(e){let t=c(this.options?.stripBasePath,""),s=new RegExp(`^${t}`),a=e.path.replace(s,""),r=e.queryStringParameters;return w(a,r)}};export{y as HuaweiApiGatewayAdapter};
//# sourceMappingURL=index.mjs.map