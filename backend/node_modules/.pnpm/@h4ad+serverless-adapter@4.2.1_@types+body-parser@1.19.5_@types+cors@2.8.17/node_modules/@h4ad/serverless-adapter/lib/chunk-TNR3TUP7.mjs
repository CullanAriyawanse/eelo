import{A as S,a as A,f as u,o as l,x as g}from"./chunk-MQYXRLYI.mjs";import{a as i}from"./chunk-OYOJMOFP.mjs";import c from"node:util";var v=class extends A{static{i(this,"DefaultHandler")}getHandler(t,e,n,R,s,E,o){return(r,a,p)=>{this.onReceiveRequest(o,r,a,s,E);let d=this.getAdapterByEventAndContext(r,a,n,o);return this.onResolveAdapter(o,d),u({event:r,context:a}),R.createResolver({event:r,context:a,callback:p,log:o,respondWithErrors:E,adapter:d}).run(()=>this.forwardRequestToFramework(t,e,r,a,d,s,o))}}onReceiveRequest(t,e,n,R,s){t.debug("SERVERLESS_ADAPTER:PROXY",()=>({event:c.inspect(e,{depth:null}),context:c.inspect(n,{depth:null}),binarySettings:R,respondWithErrors:s}))}onResolveAdapter(t,e){t.debug("SERVERLESS_ADAPTER:RESOLVED_ADAPTER_NAME: ",e.getAdapterName())}onResolveRequestValues(t,e){t.debug("SERVERLESS_ADAPTER:FORWARD_REQUEST_TO_FRAMEWORK:REQUEST_VALUES",()=>({requestValues:{...e,body:e.body?.toString()}}))}onResolveForwardedResponseToFramework(t,e){t.debug("SERVERLESS_ADAPTER:FORWARD_REQUEST_TO_FRAMEWORK:RESPONSE",()=>({response:e}))}onForwardResponse(t,e,n,R,s){t.debug("SERVERLESS_ADAPTER:FORWARD_RESPONSE:EVENT_SOURCE_RESPONSE_PARAMS",()=>({statusCode:e,body:n,headers:R,isBase64Encoded:s}))}onForwardResponseAdapterResponse(t,e,n){t.debug("SERVERLESS_ADAPTER:FORWARD_RESPONSE:EVENT_SOURCE_RESPONSE",()=>({successResponse:c.inspect(e,{depth:null}),body:n}))}async forwardRequestToFramework(t,e,n,R,s,E,o){let r=s.getRequest(n,R,o);this.onResolveRequestValues(o,r);let[a,p]=this.getServerlessRequestResponseFromAdapterRequest(r);return e.sendRequest(t,a,p),await g(p),this.onResolveForwardedResponseToFramework(o,p),this.forwardResponse(n,p,s,E,o)}forwardResponse(t,e,n,R,s){let E=e.statusCode,o=S.headers(e),r=l(o,R),a=r?"base64":"utf8",p=S.body(e).toString(a),d=r?"[BASE64_ENCODED]":p;this.onForwardResponse(s,E,d,o,r);let T=n.getResponse({event:t,statusCode:E,body:p,headers:o,isBase64Encoded:r,response:e,log:s});return this.onForwardResponseAdapterResponse(s,T,d),T}};export{v as a};
//# sourceMappingURL=chunk-TNR3TUP7.mjs.map