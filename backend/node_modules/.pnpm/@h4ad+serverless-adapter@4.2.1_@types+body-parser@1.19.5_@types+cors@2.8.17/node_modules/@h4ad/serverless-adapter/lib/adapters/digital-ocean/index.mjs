import{g as i,h as d,s as c,t as g}from"../../chunk-MQYXRLYI.mjs";import{a as p}from"../../chunk-OYOJMOFP.mjs";var l=class u{constructor(t){this.options=t}static{p(this,"HttpFunctionAdapter")}getAdapterName(){return u.name}canHandle(t){let e=t;return!!e&&e.__ow_path!==void 0&&e.__ow_method!==void 0&&e.__ow_headers!==void 0}getRequest(t){let e=t.__ow_headers,n=t.__ow_method.toUpperCase(),o=this.getPathFromEvent(t),r;if(t.__ow_body){let[s,_]=i(t.__ow_body,!!t.__ow_isBase64Encoded);r=s,e["content-length"]=String(_)}let a=e["x-forwarded-for"];return{method:n,headers:e,body:r,remoteAddress:a,path:o}}getResponse({headers:t,body:e,statusCode:n}){let o=d(t);return{statusCode:n,body:e,headers:o}}onErrorWhileForwarding({error:t,delegatedResolver:e,respondWithErrors:n,event:o,log:r}){let a=n?t.stack:"",s=this.getResponse({event:o,statusCode:500,body:a||"",headers:{},isBase64Encoded:!1,log:r});e.succeed(s)}getPathFromEvent(t){let e=c(this.options?.stripBasePath,""),n=new RegExp(`^${e}`),o=t.__ow_path.replace(n,""),r=t.__ow_query;return g(o,r||{})}};export{l as HttpFunctionAdapter};
//# sourceMappingURL=index.mjs.map