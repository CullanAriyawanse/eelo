"use strict";var g=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var o=(r,e)=>g(r,"name",{value:e,configurable:!0});var w=(r,e)=>{for(var t in e)g(r,t,{get:e[t],enumerable:!0})},C=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of A(e))!E.call(r,n)&&n!==t&&g(r,n,{get:()=>e[n],enumerable:!(s=b(e,n))||s.enumerable});return r};var k=r=>C(g({},"__esModule",{value:!0}),r);var O={};w(O,{ApolloServerMutationAdapter:()=>x});module.exports=k(O);var B=require("http");var S=require("http");function y(r){if(Buffer.isBuffer(r))return r.toString("utf8");if(typeof r=="string")return r;if(r instanceof Uint8Array)return new TextDecoder().decode(r);throw new Error(`response.write() of unexpected type: ${typeof r}`)}o(y,"getString");var v=`\r
\r
`,H=`0\r
\r
`,l=Symbol("Response body"),u=Symbol("Response headers");function m(r,e){if(Buffer.isBuffer(e)||typeof e=="string"||e instanceof Uint8Array)r[l].push(Buffer.from(e));else throw new Error(`response.write() of unexpected type: ${typeof e}`)}o(m,"addData");var h=class r extends S.ServerResponse{static{o(this,"ServerlessResponse")}constructor({method:e}){super({method:e}),this[l]=[],this[u]={},this.useChunkedEncodingByDefault=!1,this.chunkedEncoding=!1,this._header="";let t=1,s={_writableState:{},writable:!0,on:a,removeListener:a,destroy:a,cork:a,uncork:a,write:(n,i,d)=>{if(typeof i=="function"&&(d=i,i=null),this._header===""||this._wroteHeader)this.chunkedEncoding?t>0?t--:n!==H&&(m(this,n),t=3):m(this,n);else{let p=y(n),f=p.indexOf(v);if(f!==-1){let c=p.slice(f+v.length);c&&!this.chunkedEncoding&&m(this,c),this._wroteHeader=!0}}typeof d=="function"&&d()}};this.assignSocket(s)}_header;_headers;_wroteHeader;[l];[u];get headers(){return this[u]}static from(e){let t=new r({method:e.method});return t.statusCode=e.statusCode||0,t[u]=e.headers,t[l]=e.body?[Buffer.from(e.body)]:[],t.end(),t}static body(e){return Buffer.concat(e[l])}static headers(e){let t=e.getHeaders();return Object.assign(t,e[u])}setHeader(e,t){this._wroteHeader?this[u][e]=t:super.setHeader(e,t)}writeHead(e,t,s){let n=typeof t=="string"?s:t,i=Array.isArray(n)?n:[n||{}];for(let d of i)for(let p in d)if(this.setHeader(p,d[p]),!this._wroteHeader)break;return this.callNativeWriteHead(e,t,s)}callNativeWriteHead(e,t,s){return super.writeHead(e,t,s)}};var L=require("http");function T(r,e){let t=e?"base64":"utf8",s=Buffer.from(r,t),n=Buffer.byteLength(s,t);return[s,n]}o(T,"getEventBodyAsBuffer");var a=o(()=>{},"NO_OP");var me=Symbol("InternalLogger");function R(r,e){return r===void 0?e:r}o(R,"getDefaultIfUndefined");var be=require("stream");var x=class{constructor(e,t){this.baseAdapter=e;this.options=t}static{o(this,"ApolloServerMutationAdapter")}canHandle(e,t,s){return this.baseAdapter.canHandle(e,t,s)}getAdapterName(){return this.baseAdapter.getAdapterName()+"Mutation"}getRequest(e,t,s){let n=this.baseAdapter.getRequest(e,t,s);n.method="POST";let i=this.options.mutationName,d=R(this.options.mutationResultQuery,"{ __typename }"),p=JSON.stringify({operationName:i,query:`mutation ${i} ($event: String) { ${i} (event: $event) ${d} }`,variables:{event:n.body?.toString()||""}}),[f,c]=T(p,!1);return n.body=f,n.headers["content-type"]="application/json",n.headers["content-length"]=String(c),n}getResponse(e){let{data:t,errors:s}=JSON.parse(e.body);return s?this.baseAdapter.getResponse(e):this.baseAdapter.getResponse({...e,body:JSON.stringify(t[this.options.mutationName])})}onErrorWhileForwarding(e){return this.baseAdapter.onErrorWhileForwarding(e)}};0&&(module.exports={ApolloServerMutationAdapter});
//# sourceMappingURL=index.cjs.map