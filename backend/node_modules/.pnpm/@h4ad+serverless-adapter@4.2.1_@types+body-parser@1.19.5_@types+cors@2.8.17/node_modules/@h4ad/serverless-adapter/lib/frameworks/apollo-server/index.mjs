import{s as i}from"../../chunk-MQYXRLYI.mjs";import{a as n}from"../../chunk-OYOJMOFP.mjs";import{HeaderMap as x}from"@apollo/server";var l=class{constructor(s){this.options=s}static{n(this,"ApolloServerFramework")}sendRequest(s,r,t){let a=new x;for(let[e,o]of Object.entries(r.headers))o!==void 0&&a.set(e,Array.isArray(o)?o.join(", "):o.toString());let c=n(e=>Promise.resolve(e),"defaultContext"),p=n(()=>i(this.options?.context,c)({request:r,response:t}),"context"),d=r.url?.startsWith("http")?new URL(r.url).search??"":r.url?.split("?")[1]||"";s.executeHTTPGraphQLRequest({httpGraphQLRequest:{method:r.method.toUpperCase(),headers:a,body:r.body,search:d},context:p}).then(async e=>{for(let[o,f]of e.headers)t.setHeader(o,f);if(t.statusCode=e.status||200,e.body.kind==="complete"){t.end(e.body.string);return}for await(let o of e.body.asyncIterator)t.write(o),typeof t.flush=="function"&&t.flush();t.end()})}};export{l as ApolloServerFramework};
//# sourceMappingURL=index.mjs.map