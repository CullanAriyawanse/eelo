"use strict";var u=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var o=(t,e)=>u(t,"name",{value:e,configurable:!0});var L=(t,e)=>{for(var r in e)u(t,r,{get:e[r],enumerable:!0})},F=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of O(e))!P.call(t,s)&&s!==r&&u(t,s,{get:()=>e[s],enumerable:!(n=H(e,s))||n.enumerable});return t};var I=t=>F(u({},"__esModule",{value:!0}),t);var D={};L(D,{BaseBodyParserFramework:()=>i,JsonBodyParserFramework:()=>h,RawBodyParserFramework:()=>x,TextBodyParserFramework:()=>T,UrlencodedBodyParserFramework:()=>v});module.exports=I(D);var _=require("http");var A=require("http");function g(t){if(Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(t instanceof Uint8Array)return new TextDecoder().decode(t);throw new Error(`response.write() of unexpected type: ${typeof t}`)}o(g,"getString");var E=`\r
\r
`,V=`0\r
\r
`,f=Symbol("Response body"),d=Symbol("Response headers");function m(t,e){if(Buffer.isBuffer(e)||typeof e=="string"||e instanceof Uint8Array)t[f].push(Buffer.from(e));else throw new Error(`response.write() of unexpected type: ${typeof e}`)}o(m,"addData");var y=class t extends A.ServerResponse{static{o(this,"ServerlessResponse")}constructor({method:e}){super({method:e}),this[f]=[],this[d]={},this.useChunkedEncodingByDefault=!1,this.chunkedEncoding=!1,this._header="";let r=1,n={_writableState:{},writable:!0,on:a,removeListener:a,destroy:a,cork:a,uncork:a,write:(s,l,p)=>{if(typeof l=="function"&&(p=l,l=null),this._header===""||this._wroteHeader)this.chunkedEncoding?r>0?r--:s!==V&&(m(this,s),r=3):m(this,s);else{let c=g(s),R=c.indexOf(E);if(R!==-1){let w=c.slice(R+E.length);w&&!this.chunkedEncoding&&m(this,w),this._wroteHeader=!0}}typeof p=="function"&&p()}};this.assignSocket(n)}_header;_headers;_wroteHeader;[f];[d];get headers(){return this[d]}static from(e){let r=new t({method:e.method});return r.statusCode=e.statusCode||0,r[d]=e.headers,r[f]=e.body?[Buffer.from(e.body)]:[],r.end(),r}static body(e){return Buffer.concat(e[f])}static headers(e){let r=e.getHeaders();return Object.assign(r,e[d])}setHeader(e,r){this._wroteHeader?this[d][e]=r:super.setHeader(e,r)}writeHead(e,r,n){let s=typeof r=="string"?n:r,l=Array.isArray(s)?s:[s||{}];for(let p of l)for(let c in p)if(this.setHeader(c,p[c]),!this._wroteHeader)break;return this.callNativeWriteHead(e,r,n)}callNativeWriteHead(e,r,n){return super.writeHead(e,r,n)}};var N=require("http");var a=o(()=>{},"NO_OP");var Ee=Symbol("InternalLogger");function S(t,e){return t===void 0?e:t}o(S,"getDefaultIfUndefined");var He=require("stream");var i=class{constructor(e,r,n){this.framework=e;this.middleware=r;this.options=n;this.errorHandler=S(this.options?.customErrorHandler,this.defaultHandleOnError.bind(this))}static{o(this,"BaseBodyParserFramework")}errorHandler;sendRequest(e,r,n){this.middleware(r,n,this.onBodyParserFinished(e,r,n))}onBodyParserFinished(e,r,n){return s=>{if(s)return this.errorHandler(r,n,s);this.framework.sendRequest(e,r,n)}}defaultHandleOnError(e,r,n){r.setHeader("content-type","text/plain"),r.statusCode=n.statusCode,r.end(n.message)}};var b=require("body-parser");var h=class extends i{static{o(this,"JsonBodyParserFramework")}constructor(e,r){super(e,(0,b.json)(r),r)}};var C=require("body-parser");var x=class extends i{static{o(this,"RawBodyParserFramework")}constructor(e,r){super(e,(0,C.raw)(r),r)}};var k=require("body-parser");var T=class extends i{static{o(this,"TextBodyParserFramework")}constructor(e,r){super(e,(0,k.text)(r),r)}};var B=require("body-parser");var v=class extends i{static{o(this,"UrlencodedBodyParserFramework")}constructor(e,r){super(e,(0,B.urlencoded)(r),r)}};0&&(module.exports={BaseBodyParserFramework,JsonBodyParserFramework,RawBodyParserFramework,TextBodyParserFramework,UrlencodedBodyParserFramework});
//# sourceMappingURL=index.cjs.map